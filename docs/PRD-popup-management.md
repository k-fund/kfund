# PRD: íŒì—… ê´€ë¦¬ ì‹œìŠ¤í…œ

**ë²„ì „**: 1.0
**ì‘ì„±ì¼**: 2025-12-28
**í”„ë¡œì íŠ¸**: ibn ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ
**ê¸°ìˆ  ìŠ¤íƒ**: HTML5 + Vanilla JS + Cloudflare Workers + R2 + Airtable

---

## 1. ê°œìš”

### 1.1 ëª©ì 
ê´€ë¦¬ìê°€ ì›¹ì‚¬ì´íŠ¸ ë©”ì¸ í˜ì´ì§€ì— í‘œì‹œë˜ëŠ” íŒì—…(ë°°ë„ˆ) ì´ë¯¸ì§€ë¥¼ ì†ì‰½ê²Œ ë“±ë¡, ê´€ë¦¬í•  ìˆ˜ ìˆëŠ” ì‹œìŠ¤í…œ êµ¬ì¶•

### 1.2 í•µì‹¬ ìš”êµ¬ì‚¬í•­ ìš”ì•½

| í•­ëª© | ìš”êµ¬ì‚¬í•­ |
|------|----------|
| **í‘œì‹œ ìœ„ì¹˜** | ë©”ì¸ í˜ì´ì§€ (index.html) |
| **PC ë ˆì´ì•„ì›ƒ** | 4ê°œ/ì¤„, ìµœëŒ€ 2ì¤„ (8ê°œ), ì™¼ìª½â†’ì˜¤ë¥¸ìª½ ìˆœì„œ |
| **ëª¨ë°”ì¼ ë ˆì´ì•„ì›ƒ** | ì¢Œìš° ìŠ¬ë¼ì´ë“œ, í•œ ë²ˆì— 1ê°œ í‘œì‹œ |
| **íŒì—… ì‚¬ì´ì¦ˆ** | ì •ì‚¬ê°í˜• (1:1 ë¹„ìœ¨) |
| **ì´ë¯¸ì§€ í¬ë§·** | WebP, 100KB ìë™ ì••ì¶• |
| **ì—…ë¡œë“œ ë°©ì‹** | íŒŒì¼ ì—…ë¡œë“œ â†’ R2 ì €ì¥ |
| **ë°ì´í„° ê´€ë¦¬** | Airtable ìºì‹œ ì—°ë™ |
| **ê²Œì¬ ê´€ë¦¬** | ON/OFF í† ê¸€, ì‹œì‘ì¼/ì¢…ë£Œì¼ ì„¤ì • |

---

## 2. ê¸°ìˆ  í‘œì¤€ ë° ì°¸ê³  ìë£Œ

### 2.1 ì ‘ê·¼ì„± (WCAG 2.2 ì¤€ìˆ˜)

> ì¶œì²˜: [W3C WAI Dialog Modal Pattern](https://www.w3.org/WAI/ARIA/apg/patterns/dialog-modal/), [Equalize Digital - Accessible Modals](https://equalizedigital.com/how-to-code-accessible-modals/)

#### í•„ìˆ˜ ìš”êµ¬ì‚¬í•­
- **í¬ì»¤ìŠ¤ ê´€ë¦¬**: íŒì—… ì—´ë¦´ ë•Œ í¬ì»¤ìŠ¤ ì´ë™, ë‹«í ë•Œ ì›ë˜ ìœ„ì¹˜ ë³µê·€
- **í‚¤ë³´ë“œ ë„¤ë¹„ê²Œì´ì…˜**: Tab/Shift+Tab ìˆœí™˜, ESC í‚¤ë¡œ ë‹«ê¸°
- **ARIA ì†ì„±**: `role="dialog"`, `aria-labelledby`, `aria-describedby`
- **í¬ì»¤ìŠ¤ íŠ¸ë©**: íŒì—… ë‚´ë¶€ì—ì„œë§Œ Tab ìˆœí™˜
- **ìŠ¤í¬ë¦° ë¦¬ë”**: íŒì—… ì—´ë¦¼/ë‹«í˜ ìƒíƒœ ì•ˆë‚´

#### êµ¬í˜„ ì˜ˆì‹œ
```html
<div role="dialog"
     aria-modal="true"
     aria-labelledby="popup-title"
     aria-describedby="popup-desc">
  <h2 id="popup-title" class="sr-only">í”„ë¡œëª¨ì…˜ ì•ˆë‚´</h2>
  <img src="..." alt="ì´ë²¤íŠ¸ ë°°ë„ˆ ì„¤ëª…">
  <button aria-label="íŒì—… ë‹«ê¸°">Ã—</button>
</div>
```

### 2.2 ì´ë¯¸ì§€ ì²˜ë¦¬ (Cloudflare R2 + WebP)

> ì¶œì²˜: [Cloudflare R2 Image Hosting Guide 2025](https://medium.com/@leonwong282/the-complete-beginners-guide-to-cloudflare-r2-image-hosting-2025-f9090f8c2bb7), [Cloudflare Polish Compression](https://developers.cloudflare.com/images/polish/compression/)

#### ê¶Œì¥ ì„¤ì •
- **í¬ë§·**: WebP (PNG ëŒ€ë¹„ 26% ê°ì†Œ, JPEG ëŒ€ë¹„ 17% ê°ì†Œ)
- **í’ˆì§ˆ**: 80-85 (íŒŒì¼ í¬ê¸°ì™€ í™”ì§ˆ ê· í˜•)
- **ìµœëŒ€ ìš©ëŸ‰**: 100KB ì´í•˜ë¡œ ìë™ ì••ì¶•
- **ì›ë³¸ ê¶Œì¥**: ì •ì‚¬ê°í˜• 800Ã—800px ì´ìƒ

#### ì••ì¶• ì „ëµ
```javascript
// Sharp ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš© (ê¸°ì¡´ í”„ë¡œì íŠ¸ì— ì„¤ì¹˜ë¨)
import sharp from 'sharp';

async function compressToWebP(buffer, maxSizeKB = 100) {
  let quality = 85;
  let result = await sharp(buffer)
    .resize(800, 800, { fit: 'cover' })
    .webp({ quality })
    .toBuffer();

  // 100KB ì´í•˜ê°€ ë  ë•Œê¹Œì§€ í’ˆì§ˆ ì¡°ì ˆ
  while (result.length > maxSizeKB * 1024 && quality > 40) {
    quality -= 10;
    result = await sharp(buffer)
      .resize(800, 800, { fit: 'cover' })
      .webp({ quality })
      .toBuffer();
  }

  return result;
}
```

### 2.3 Airtable ìºì‹œ ì „ëµ

> ì¶œì²˜: [Airtable API Rate Limits](https://support.airtable.com/docs/managing-api-call-limits-in-airtable), [Aircache - High Performance Cache](https://railway.com/deploy/aircache)

#### í˜„ì¬ í”„ë¡œì íŠ¸ êµ¬ì¡°
- **Worker API**: `https://ibn-analytics.a01027770093.workers.dev`
- **Airtable Base**: `appwr3xRqHrc3z0zQ`
- **Rate Limit**: 5 requests/second (Free í”Œëœ)

#### ìºì‹œ ì „ëµ
1. **Worker ë ˆì´ì–´ ìºì‹œ**: KV Storage ë˜ëŠ” Cache API í™œìš©
2. **TTL ì„¤ì •**: 5ë¶„ (íŒì—… ë°ì´í„°ëŠ” ìì£¼ ë³€ê²½ë˜ì§€ ì•ŠìŒ)
3. **ì¦‰ì‹œ ë¬´íš¨í™”**: ê´€ë¦¬ìê°€ ìˆ˜ì • ì‹œ ìºì‹œ ê°•ì œ ê°±ì‹ 

---

## 3. ë°ì´í„° êµ¬ì¡°

### 3.1 Airtable í…Œì´ë¸” ìŠ¤í‚¤ë§ˆ

**í…Œì´ë¸”ëª…**: `Popups`

| í•„ë“œëª… | íƒ€ì… | í•„ìˆ˜ | ì„¤ëª… |
|--------|------|------|------|
| `id` | Auto Number | Y | ê³ ìœ  ID |
| `title` | Single Line Text | Y | íŒì—… ì œëª© (ê´€ë¦¬ìš©) |
| `imageUrl` | URL | Y | R2 ì´ë¯¸ì§€ URL |
| `linkUrl` | URL | N | í´ë¦­ ì‹œ ì´ë™í•  ë§í¬ |
| `linkTarget` | Single Select | N | `_self` / `_blank` |
| `order` | Number | Y | í‘œì‹œ ìˆœì„œ (1-8) |
| `isActive` | Checkbox | Y | ê²Œì¬ ì—¬ë¶€ (ON/OFF) |
| `startDate` | Date | N | ê²Œì¬ ì‹œì‘ì¼ |
| `endDate` | Date | N | ê²Œì¬ ì¢…ë£Œì¼ |
| `altText` | Single Line Text | Y | ì´ë¯¸ì§€ ëŒ€ì²´ í…ìŠ¤íŠ¸ (ì ‘ê·¼ì„±) |
| `createdAt` | Created Time | Y | ìƒì„±ì¼ |
| `updatedAt` | Last Modified Time | Y | ìˆ˜ì •ì¼ |

### 3.2 R2 ë²„í‚· êµ¬ì¡°

```
ibn-popups/
â”œâ”€â”€ popup-001.webp
â”œâ”€â”€ popup-002.webp
â”œâ”€â”€ popup-003.webp
â””â”€â”€ ...
```

**íŒŒì¼ëª… ê·œì¹™**: `popup-{timestamp}-{random}.webp`

---

## 4. API ì„¤ê³„

### 4.1 Worker API ì—”ë“œí¬ì¸íŠ¸

#### íŒì—… ëª©ë¡ ì¡°íšŒ (ê³µê°œ)
```
GET /popups
Response: {
  success: true,
  data: [
    {
      id: 1,
      title: "ì‹ ë…„ ì´ë²¤íŠ¸",
      imageUrl: "https://pub-xxx.r2.dev/popup-001.webp",
      linkUrl: "/event/newyear",
      linkTarget: "_self",
      order: 1,
      altText: "2025 ì‹ ë…„ ì •ì±…ìê¸ˆ ìƒë‹´ ì´ë²¤íŠ¸"
    },
    ...
  ]
}
```

#### íŒì—… ëª©ë¡ ì¡°íšŒ (ê´€ë¦¬ììš©, ì „ì²´)
```
GET /admin/popups
Headers: Authorization: Bearer {token}
Response: {
  success: true,
  data: [
    {
      id: 1,
      title: "ì‹ ë…„ ì´ë²¤íŠ¸",
      imageUrl: "...",
      linkUrl: "...",
      linkTarget: "_self",
      order: 1,
      isActive: true,
      startDate: "2025-01-01",
      endDate: "2025-01-31",
      altText: "...",
      createdAt: "...",
      updatedAt: "..."
    },
    ...
  ]
}
```

#### íŒì—… ìƒì„±
```
POST /admin/popups
Headers: Authorization: Bearer {token}
Content-Type: multipart/form-data
Body: {
  image: File (PNG/JPG/WebP, ìµœëŒ€ 5MB)
  title: string
  linkUrl?: string
  linkTarget?: "_self" | "_blank"
  order: number (1-8)
  isActive: boolean
  startDate?: string (YYYY-MM-DD)
  endDate?: string (YYYY-MM-DD)
  altText: string
}
Response: {
  success: true,
  data: { id: 1, imageUrl: "...", ... }
}
```

#### íŒì—… ìˆ˜ì •
```
PATCH /admin/popups/:id
Headers: Authorization: Bearer {token}
Content-Type: multipart/form-data
Body: { ...ë³€ê²½í•  í•„ë“œë“¤ }
Response: { success: true, data: {...} }
```

#### íŒì—… ì‚­ì œ
```
DELETE /admin/popups/:id
Headers: Authorization: Bearer {token}
Response: { success: true }
```

#### ì´ë¯¸ì§€ ì—…ë¡œë“œ (ë³„ë„)
```
POST /admin/upload/popup
Headers: Authorization: Bearer {token}
Content-Type: multipart/form-data
Body: { image: File }
Response: {
  success: true,
  data: {
    url: "https://pub-xxx.r2.dev/popup-xxx.webp",
    size: 87654,
    width: 800,
    height: 800
  }
}
```

---

## 5. UI/UX ì„¤ê³„

### 5.1 ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ - íŒì—… ê´€ë¦¬ í˜ì´ì§€

#### ì‚¬ì´ë“œë°” ë©”ë‰´ ì¶”ê°€
```
â”œâ”€â”€ ëŒ€ì‹œë³´ë“œ
â”œâ”€â”€ ì ‘ìˆ˜ë‚´ì—­
â”œâ”€â”€ ê²Œì‹œíŒ ê´€ë¦¬
â”œâ”€â”€ ì„ì§ì› ê´€ë¦¬
â”œâ”€â”€ íŒì—… ê´€ë¦¬ â† NEW
â”œâ”€â”€ ë°©ë¬¸í†µê³„
â”œâ”€â”€ í˜ì´ì§€ í¸ì§‘
â””â”€â”€ ì„¤ì •
```

#### í˜ì´ì§€ ë ˆì´ì•„ì›ƒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ íŒì—… ê´€ë¦¬                                    [+ ìƒˆ íŒì—… ë“±ë¡] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ğŸ–¼ï¸      â”‚  â”‚  ğŸ–¼ï¸      â”‚  â”‚  ğŸ–¼ï¸      â”‚  â”‚  + ì¶”ê°€  â”‚   â”‚
â”‚  â”‚ ì´ë¯¸ì§€1  â”‚  â”‚ ì´ë¯¸ì§€2  â”‚  â”‚ ì´ë¯¸ì§€3  â”‚  â”‚          â”‚   â”‚
â”‚  â”‚          â”‚  â”‚          â”‚  â”‚          â”‚  â”‚          â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”‚ ì œëª©...  â”‚  â”‚ ì œëª©...  â”‚  â”‚ ì œëª©...  â”‚                   â”‚
â”‚  â”‚ ğŸŸ¢ ê²Œì¬ì¤‘ â”‚  â”‚ âš« ë¹„í™œì„± â”‚  â”‚ ğŸŸ¡ ì˜ˆì•½  â”‚                   â”‚
â”‚  â”‚ [í¸ì§‘]   â”‚  â”‚ [í¸ì§‘]   â”‚  â”‚ [í¸ì§‘]   â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                                             â”‚
â”‚  â„¹ï¸ ë“œë˜ê·¸í•˜ì—¬ ìˆœì„œ ë³€ê²½ ê°€ëŠ¥ (ìµœëŒ€ 8ê°œ)                      â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### íŒì—… ë“±ë¡/ìˆ˜ì • ëª¨ë‹¬

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ íŒì—… ë“±ë¡                              [Ã—] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                             â”‚
â”‚  ì´ë¯¸ì§€ ì—…ë¡œë“œ                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                     â”‚   â”‚
â”‚  â”‚    ğŸ“ í´ë¦­í•˜ì—¬ ì´ë¯¸ì§€ ì„ íƒ          â”‚   â”‚
â”‚  â”‚    ë˜ëŠ” ë“œë˜ê·¸ ì•¤ ë“œë¡­              â”‚   â”‚
â”‚  â”‚                                     â”‚   â”‚
â”‚  â”‚    (ì •ì‚¬ê°í˜• ê¶Œì¥, ìµœëŒ€ 5MB)        â”‚   â”‚
â”‚  â”‚    ìë™ìœ¼ë¡œ WebP 100KB ì••ì¶•         â”‚   â”‚
â”‚  â”‚                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                             â”‚
â”‚  ì œëª© (ê´€ë¦¬ìš©) *                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ 2025 ì‹ ë…„ ì´ë²¤íŠ¸                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                             â”‚
â”‚  ëŒ€ì²´ í…ìŠ¤íŠ¸ (ì ‘ê·¼ì„±) *                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ 2025ë…„ ì‹ ë…„ ì •ì±…ìê¸ˆ ìƒë‹´ ì´ë²¤íŠ¸    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                             â”‚
â”‚  í´ë¦­ ì‹œ ì´ë™ ë§í¬                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ https://example.com/event           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â—‹ ê°™ì€ ì°½  â— ìƒˆ ì°½                        â”‚
â”‚                                             â”‚
â”‚  ê²Œì¬ ì„¤ì •                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ [ON] ê²Œì¬ í™œì„±í™”                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                             â”‚
â”‚  ê²Œì¬ ê¸°ê°„ (ì„ íƒ)                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” ~ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ 2025-01-01     â”‚   â”‚ 2025-01-31     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                             â”‚
â”‚           [ì·¨ì†Œ]  [ì €ì¥]                    â”‚
â”‚                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 ë©”ì¸ í˜ì´ì§€ íŒì—… í‘œì‹œ (ê³µê°œ)

#### PC ë ˆì´ì•„ì›ƒ (1024px+)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚   â”‚          â”‚  â”‚          â”‚  â”‚          â”‚  â”‚          â”‚          â”‚
â”‚   â”‚  íŒì—…1   â”‚  â”‚  íŒì—…2   â”‚  â”‚  íŒì—…3   â”‚  â”‚  íŒì—…4   â”‚          â”‚
â”‚   â”‚          â”‚  â”‚          â”‚  â”‚          â”‚  â”‚          â”‚          â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚   â”‚          â”‚  â”‚          â”‚  â”‚          â”‚  â”‚          â”‚          â”‚
â”‚   â”‚  íŒì—…5   â”‚  â”‚  íŒì—…6   â”‚  â”‚  íŒì—…7   â”‚  â”‚  íŒì—…8   â”‚          â”‚
â”‚   â”‚          â”‚  â”‚          â”‚  â”‚          â”‚  â”‚          â”‚          â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                     â”‚
â”‚   [ëª¨ë‘ ë‹«ê¸°]                     [ì˜¤ëŠ˜ í•˜ë£¨ ë³´ì§€ ì•Šê¸°]             â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

- **ë°°ì—´**: CSS Grid 4ì—´, gap: 16px
- **íŒì—… í¬ê¸°**: ê³ ì • ì •ì‚¬ê°í˜• (ì˜ˆ: 200Ã—200px)
- **ì •ë ¬**: ì™¼ìª½ì—ì„œ ì˜¤ë¥¸ìª½, ìœ„ì—ì„œ ì•„ë˜
- **í¬ê°œì§€ì§€ ì•ŠìŒ**: ê° íŒì—…ì´ ë…ë¦½ì ìœ¼ë¡œ ë°°ì¹˜

#### ëª¨ë°”ì¼ ë ˆì´ì•„ì›ƒ (~767px)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                             â”‚
â”‚  â† â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â†’     â”‚
â”‚    â”‚               â”‚        â”‚
â”‚    â”‚    íŒì—…1      â”‚        â”‚
â”‚    â”‚               â”‚        â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                             â”‚
â”‚         â— â—‹ â—‹ â—‹             â”‚
â”‚                             â”‚
â”‚  [ë‹«ê¸°] [ì˜¤ëŠ˜ í•˜ë£¨ ë³´ì§€ ì•Šê¸°] â”‚
â”‚                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

- **ìŠ¬ë¼ì´ë“œ**: ì¢Œìš° ìŠ¤ì™€ì´í”„ë¡œ íƒìƒ‰
- **ì¸ë””ì¼€ì´í„°**: í•˜ë‹¨ dot í‘œì‹œ
- **í¬ê¸°**: í™”ë©´ ë„ˆë¹„ 80%, ì •ì‚¬ê°í˜•

---

## 6. êµ¬í˜„ ê³„íš

### 6.1 íŒŒì¼ êµ¬ì¡°

```
F:\pola_homepage\4.20th_ijonghyun_ibn\
â”œâ”€â”€ admin/
â”‚   â””â”€â”€ popups.html          â† NEW: íŒì—… ê´€ë¦¬ í˜ì´ì§€
â”œâ”€â”€ js/
â”‚   â”œâ”€â”€ popups-admin.js      â† NEW: ê´€ë¦¬ì íŒì—… ë¡œì§
â”‚   â””â”€â”€ popups-public.js     â† NEW: ê³µê°œ í˜ì´ì§€ íŒì—… ë¡œì§
â”œâ”€â”€ css/
â”‚   â””â”€â”€ dashboard.css        â† MODIFY: íŒì—… ê´€ë¦¬ ìŠ¤íƒ€ì¼ ì¶”ê°€
â”‚   â””â”€â”€ main.css             â† MODIFY: ê³µê°œ íŒì—… ìŠ¤íƒ€ì¼ ì¶”ê°€
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ worker.js            â† MODIFY: íŒì—… API ì—”ë“œí¬ì¸íŠ¸ ì¶”ê°€
â””â”€â”€ index.html               â† MODIFY: íŒì—… í‘œì‹œ ì˜ì—­ ì¶”ê°€
```

### 6.2 êµ¬í˜„ ë‹¨ê³„

#### Phase 1: ë°±ì—”ë“œ (Worker API + R2)
1. R2 ë²„í‚· ìƒì„± ë° ì—°ê²°
2. ì´ë¯¸ì§€ ì—…ë¡œë“œ API êµ¬í˜„ (WebP ì••ì¶• í¬í•¨)
3. Airtable `Popups` í…Œì´ë¸” ìƒì„±
4. CRUD API ì—”ë“œí¬ì¸íŠ¸ êµ¬í˜„
5. ìºì‹œ ë ˆì´ì–´ êµ¬í˜„

#### Phase 2: ê´€ë¦¬ì UI
1. `admin/popups.html` í˜ì´ì§€ ìƒì„±
2. ì‚¬ì´ë“œë°” ë©”ë‰´ì— "íŒì—… ê´€ë¦¬" ì¶”ê°€
3. íŒì—… ëª©ë¡ ê·¸ë¦¬ë“œ UI
4. ë“±ë¡/ìˆ˜ì • ëª¨ë‹¬
5. ë“œë˜ê·¸ ì•¤ ë“œë¡­ ìˆœì„œ ë³€ê²½
6. ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸° ë° ì—…ë¡œë“œ

#### Phase 3: ê³µê°œ í˜ì´ì§€ íŒì—…
1. `index.html`ì— íŒì—… ì»¨í…Œì´ë„ˆ ì¶”ê°€
2. PC ê·¸ë¦¬ë“œ ë ˆì´ì•„ì›ƒ êµ¬í˜„
3. ëª¨ë°”ì¼ ìŠ¬ë¼ì´ë“œ êµ¬í˜„
4. "ì˜¤ëŠ˜ í•˜ë£¨ ë³´ì§€ ì•Šê¸°" ê¸°ëŠ¥
5. ì ‘ê·¼ì„± êµ¬í˜„ (ARIA, í‚¤ë³´ë“œ)

#### Phase 4: í…ŒìŠ¤íŠ¸ ë° ìµœì í™”
1. ì ‘ê·¼ì„± í…ŒìŠ¤íŠ¸ (WAVE, axe)
2. ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ (ì´ë¯¸ì§€ ë¡œë”©)
3. ë°˜ì‘í˜• í…ŒìŠ¤íŠ¸
4. ë¸Œë¼ìš°ì € í˜¸í™˜ì„± í…ŒìŠ¤íŠ¸

---

## 7. ê¸°ìˆ  ìƒì„¸

### 7.1 ì´ë¯¸ì§€ ì••ì¶• (Worker ë‚´ êµ¬í˜„)

```javascript
// Cloudflare Workerì—ì„œ ì´ë¯¸ì§€ ì²˜ë¦¬
import { S3Client, PutObjectCommand } from '@aws-sdk/client-s3';

async function uploadPopupImage(file, env) {
  // 1. ì´ë¯¸ì§€ ì½ê¸°
  const buffer = await file.arrayBuffer();

  // 2. WebP ë³€í™˜ ë° ì••ì¶• (Cloudflare Image Resizing ì‚¬ìš©)
  const resizedImage = await fetch(
    'https://workers.dev/resize',
    {
      method: 'POST',
      body: buffer,
      headers: {
        'Content-Type': file.type,
        'X-Resize-Options': JSON.stringify({
          width: 800,
          height: 800,
          fit: 'cover',
          format: 'webp',
          quality: 85
        })
      }
    }
  );

  // 3. R2ì— ì—…ë¡œë“œ
  const filename = `popup-${Date.now()}-${Math.random().toString(36).slice(2)}.webp`;

  const s3Client = new S3Client({
    region: 'auto',
    endpoint: `https://${env.CF_ACCOUNT_ID}.r2.cloudflarestorage.com`,
    credentials: {
      accessKeyId: env.R2_ACCESS_KEY_ID,
      secretAccessKey: env.R2_SECRET_ACCESS_KEY
    }
  });

  await s3Client.send(new PutObjectCommand({
    Bucket: 'ibn-popups',
    Key: filename,
    Body: await resizedImage.arrayBuffer(),
    ContentType: 'image/webp'
  }));

  return `https://pub-xxx.r2.dev/${filename}`;
}
```

### 7.2 ê²Œì¬ ê¸°ê°„ í•„í„°ë§

```javascript
function getActivePopups(popups) {
  const now = new Date();
  const today = now.toISOString().split('T')[0];

  return popups
    .filter(popup => {
      // isActive ì²´í¬
      if (!popup.isActive) return false;

      // ì‹œì‘ì¼ ì²´í¬
      if (popup.startDate && popup.startDate > today) return false;

      // ì¢…ë£Œì¼ ì²´í¬
      if (popup.endDate && popup.endDate < today) return false;

      return true;
    })
    .sort((a, b) => a.order - b.order)
    .slice(0, 8); // ìµœëŒ€ 8ê°œ
}
```

### 7.3 ëª¨ë°”ì¼ ìŠ¬ë¼ì´ë“œ êµ¬í˜„

```javascript
// Vanilla JS í„°ì¹˜ ìŠ¬ë¼ì´ë“œ
class PopupSlider {
  constructor(container) {
    this.container = container;
    this.slides = container.querySelectorAll('.popup-slide');
    this.currentIndex = 0;
    this.startX = 0;
    this.isDragging = false;

    this.init();
  }

  init() {
    this.container.addEventListener('touchstart', this.onTouchStart.bind(this));
    this.container.addEventListener('touchmove', this.onTouchMove.bind(this));
    this.container.addEventListener('touchend', this.onTouchEnd.bind(this));
  }

  onTouchStart(e) {
    this.startX = e.touches[0].clientX;
    this.isDragging = true;
  }

  onTouchMove(e) {
    if (!this.isDragging) return;
    const currentX = e.touches[0].clientX;
    const diff = this.startX - currentX;
    // ìŠ¬ë¼ì´ë“œ ì´ë™ ì‹œê° íš¨ê³¼
  }

  onTouchEnd(e) {
    const endX = e.changedTouches[0].clientX;
    const diff = this.startX - endX;

    if (Math.abs(diff) > 50) {
      if (diff > 0 && this.currentIndex < this.slides.length - 1) {
        this.goTo(this.currentIndex + 1);
      } else if (diff < 0 && this.currentIndex > 0) {
        this.goTo(this.currentIndex - 1);
      }
    }

    this.isDragging = false;
  }

  goTo(index) {
    this.currentIndex = index;
    const offset = -index * 100;
    this.container.style.transform = `translateX(${offset}%)`;
    this.updateIndicators();
  }
}
```

---

## 8. ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

### 8.1 ì´ë¯¸ì§€ ì—…ë¡œë“œ ë³´ì•ˆ
- **íŒŒì¼ íƒ€ì… ê²€ì¦**: MIME íƒ€ì… + ë§¤ì§ ë„˜ë²„ í™•ì¸
- **íŒŒì¼ í¬ê¸° ì œí•œ**: ìµœëŒ€ 5MB
- **íŒŒì¼ëª… ë‚œë…í™”**: íƒ€ì„ìŠ¤íƒ¬í”„ + ëœë¤ ë¬¸ìì—´
- **ì•…ì„± ì½”ë“œ ìŠ¤ìº”**: ì´ë¯¸ì§€ ë¦¬ì‚¬ì´ì§•ìœ¼ë¡œ ë©”íƒ€ë°ì´í„° ì œê±°

### 8.2 API ë³´ì•ˆ
- **ì¸ì¦ í•„ìˆ˜**: ê´€ë¦¬ì APIëŠ” Bearer í† í° ê²€ì¦
- **Rate Limiting**: ë¶„ë‹¹ 60íšŒ ìš”ì²­ ì œí•œ
- **ì…ë ¥ ê²€ì¦**: ëª¨ë“  í•„ë“œ sanitization

---

## 9. ì„±ëŠ¥ ìµœì í™”

### 9.1 ì´ë¯¸ì§€
- WebP í¬ë§· ì‚¬ìš© (26% ìš©ëŸ‰ ê°ì†Œ)
- 100KB ì´í•˜ë¡œ ì••ì¶•
- Cloudflare CDN ìºì‹œ (1ë…„)
- Lazy Loading ì ìš©

### 9.2 API
- Airtable ìºì‹œ (5ë¶„ TTL)
- Cloudflare KV ë˜ëŠ” Cache API í™œìš©
- ìµœì†Œí•œì˜ í•„ë“œë§Œ ë°˜í™˜

---

## 10. ì²´í¬ë¦¬ìŠ¤íŠ¸

### 10.1 ê¸°ëŠ¥ ìš”êµ¬ì‚¬í•­
- [ ] ê´€ë¦¬ì ì‚¬ì´ë“œë°”ì— "íŒì—… ê´€ë¦¬" ë©”ë‰´ ì¶”ê°€
- [ ] íŒì—… ëª©ë¡ ì¡°íšŒ (ê·¸ë¦¬ë“œ í˜•íƒœ)
- [ ] íŒì—… ë“±ë¡ (ì´ë¯¸ì§€ ì—…ë¡œë“œ, ì œëª©, ë§í¬, ìˆœì„œ)
- [ ] íŒì—… ìˆ˜ì •
- [ ] íŒì—… ì‚­ì œ
- [ ] ON/OFF í† ê¸€
- [ ] ê²Œì¬ ì‹œì‘ì¼/ì¢…ë£Œì¼ ì„¤ì •
- [ ] ë“œë˜ê·¸ ì•¤ ë“œë¡­ ìˆœì„œ ë³€ê²½
- [ ] ì´ë¯¸ì§€ WebP 100KB ìë™ ì••ì¶•
- [ ] R2 ë²„í‚· ì—…ë¡œë“œ
- [ ] Airtable ë°ì´í„° ì €ì¥

### 10.2 í™”ë©´ ìš”êµ¬ì‚¬í•­
- [ ] PC: 4ì—´ ê·¸ë¦¬ë“œ, ìµœëŒ€ 2ì¤„ (8ê°œ)
- [ ] ëª¨ë°”ì¼: ì¢Œìš° ìŠ¬ë¼ì´ë“œ
- [ ] ì •ì‚¬ê°í˜• íŒì—… ë¹„ìœ¨
- [ ] í¬ê°œì§€ì§€ ì•ŠëŠ” ë°°ì¹˜
- [ ] "ì˜¤ëŠ˜ í•˜ë£¨ ë³´ì§€ ì•Šê¸°" ê¸°ëŠ¥

### 10.3 ì ‘ê·¼ì„± ìš”êµ¬ì‚¬í•­
- [ ] `role="dialog"` ì ìš©
- [ ] `aria-modal="true"` ì ìš©
- [ ] `aria-labelledby` ì ìš©
- [ ] ESC í‚¤ë¡œ ë‹«ê¸°
- [ ] Tab í‚¤ í¬ì»¤ìŠ¤ íŠ¸ë©
- [ ] ì´ë¯¸ì§€ alt í…ìŠ¤íŠ¸

### 10.4 ê¸°ìˆ  ìš”êµ¬ì‚¬í•­
- [ ] Cloudflare Worker API í™•ì¥
- [ ] R2 ë²„í‚· ì—°ë™
- [ ] Airtable Popups í…Œì´ë¸”
- [ ] ìºì‹œ ì „ëµ êµ¬í˜„

---

## 11. ì°¸ê³  ìë£Œ

### ì ‘ê·¼ì„±
- [W3C WAI Dialog Modal Pattern](https://www.w3.org/WAI/ARIA/apg/patterns/dialog-modal/)
- [Equalize Digital - Accessible Modals](https://equalizedigital.com/how-to-code-accessible-modals/)
- [WCAG 2.2 Best Practices 2025](https://www.wcag.com/resource/ux-quick-tips-for-designers/)

### Cloudflare
- [Cloudflare R2 Image Hosting 2025](https://medium.com/@leonwong282/the-complete-beginners-guide-to-cloudflare-r2-image-hosting-2025-f9090f8c2bb7)
- [Cloudflare Polish Compression](https://developers.cloudflare.com/images/polish/compression/)
- [Transform via Workers](https://developers.cloudflare.com/images/transform-images/transform-via-workers/)

### Airtable
- [Airtable API Rate Limits](https://support.airtable.com/docs/managing-api-call-limits-in-airtable)
- [Aircache - High Performance Cache](https://railway.com/deploy/aircache)

---

**ë¬¸ì„œ ë**
